var AssetAdapter=function(){function e(){}var t=(__define,e),n=t.prototype;return n.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var a=RES.getRes(e);a?i(a):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var Config=function(){function e(){}var t=(__define,e);t.prototype;return e.gameId=100047564,e.gameName="果汁世界",e}();egret.registerClass(Config,"Config");var FileManager=function(){function e(){}var t=(__define,e);t.prototype;return e.getLvConfigDataById=function(e){var t=Util.formatString(["%04s",e]),n=RES.getRes("lvcfg_json");for(var i in n){var a=n[i];if(a.id==t.toString())return a}return null},e}();egret.registerClass(FileManager,"FileManager");var PlayerData=function(){function e(){}var t=(__define,e);t.prototype;return e.initData=function(){var e=this.get();e&&(this.data=JSON.parse(e))},e.saveLv=function(e){e>=this.data.fightLv&&(this.data.fightLv=e),this.save()},e.get=function(){return egret.localStorage.getItem(this.prefix+"_data")},e.save=function(){var e=JSON.stringify(this.data);egret.localStorage.setItem(this.prefix+"_data",e)},e.prefix="fruit_juice_world",e.data={fightLv:1,gold:0,heart:0},e}();egret.registerClass(PlayerData,"PlayerData");var SceneManager=function(){function e(){}var t=(__define,e);t.prototype;return e.gotoLogin=function(){var t=new ResLoading;Director.getInstance().pushScene(t);var n=(new CallBackFunc).handler(e.onLogin,this,[]);t.load(["com","fruit","login","mp3"],n)},e.onLogin=function(){var e=new Login;Director.getInstance().replaceScene(e)},e.gotoIndex=function(){var t=new ResLoading;Director.getInstance().pushScene(t);var n=(new CallBackFunc).handler(e.onIndex,this,[]);t.load(["map","index","json"],n)},e.onIndex=function(){var e=new IndexScene;Director.getInstance().replaceScene(e)},e.gotoGame=function(){var t=new ResLoading;Director.getInstance().pushScene(t);var n=(new CallBackFunc).handler(e.onGame,this,[]);t.load(["cell","fruit","json"],n)},e.onGame=function(){var e=new GameScene;Director.getInstance().replaceScene(e)},e.replayLv=function(){GameData.curScore=0,GameData.curStep=GameData.targetStep,GameData.isOver=!1,GameData.isWin=!1;var e=new GameScene;Director.getInstance().replaceScene(e)},e}();egret.registerClass(SceneManager,"SceneManager");var SoundsManager=function(){function e(){}var t=(__define,e);t.prototype;return e.playBtnMusic=function(){this.playMusic("button_mp3")},e.playClickCellMusic=function(){this.playMusic("dianji_mp3")},e.playWinMusic=function(){this.playMusic("win_mp3")},e.playLoseMusic=function(){this.playMusic("lose_mp3")},e.playMusic=function(e){var t=RES.getRes(e.toString());t&&(this.bgSoundChannel=t.play(0,1))},e.playRemoveCellMusic=function(e){var t=["efx_combine_1_mp3","efx_combine_2_mp3","efx_combine_3_mp3","efx_combine_4_mp3","efx_combine_5_mp3","efx_combine_6_mp3","efx_combine_7_mp3"];e>=6&&(e=6),this.playMusic(t[e])},e.bgSoundChannel=null,e}();egret.registerClass(SoundsManager,"SoundsManager");var LoadingUI=function(e){function t(){e.call(this),this.createView()}__extends(t,e);var n=(__define,t),i=n.prototype;return i.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},i.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(e){function t(){e.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(t,e);var n=(__define,t),i=n.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},i.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},i.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},i.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},i.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},i.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},i.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},i.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},i.startCreateScene=function(){Director.getInstance().initWithMain(this),PlayerData.initData(),SceneManager.gotoLogin()},t}(eui.UILayer);egret.registerClass(Main,"Main");var Cell=function(e){function t(t){e.call(this),this.id=0,this.row=0,this.column=0,this.moveFlag=!1,this.checkFlag=!1,this.sprite=null,this.isAction=!1,this.isSelected=!1,this.moveSpeed=400,this.id=t,this.sprite=new eui.Image,this.addChild(this.sprite),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onAddStage=function(){this.init()},i.init=function(){var e=["game_Apple_png","game_Blueberry_png","game_Grape_png","game_Lemon_png","game_Watermelon_png"],n=e[this.id-1],i=RES.getRes(n);i?(this.width=t.CellWidth,this.height=t.CellHeight,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.sprite.source=i,this.sprite.width=t.CellWidth,this.sprite.height=t.CellHeight,this.sprite.anchorOffsetX=this.sprite.width/2,this.sprite.anchorOffsetY=this.sprite.height/2,this.sprite.x=this.width/2,this.sprite.y=this.height/2):console.error("没有对应的texture",n)},i.setSelect=function(e){this.isSelected!=e&&(this.isSelected=e,e&&this.runSelectedAni())},i.runSelectedAni=function(){if(0==this.isAction){this.isAction=!0,SoundsManager.playClickCellMusic(),egret.Tween.removeTweens(this);var e=egret.Tween.get(this);e.to({scaleX:.8,scaleY:1.3},100,egret.Ease.bounceIn).to({scaleX:1.1,scaleY:1},100,egret.Ease.bounceOut).to({scaleX:1,scaleY:1},100,egret.Ease.backIn).call(function(){this.isAction=!1},this)}},i.clean=function(){var e=this;Util.removeByElements(CellManager.cleanList,this),CellManager.cleanCell(this);var t=egret.Tween.get(this);t.to({scaleX:.4,scaleY:.4},200).call(function(){e.sendCleanOverEvent()},this).wait(50).call(function(){e.parent&&e.parent.removeChild(e)},this)},i.sendCleanOverEvent=function(){var e=new GameEvent(GameEvent.CleanOver);this.dispatchEvent(e)},i.drop=function(e,t){var n=this,i=CellManager.getCellPosX(t),a=CellManager.getCellPosY(e),r=this.getDistance({x:this.x,y:this.y},{x:i,y:a}),s=r/this.moveSpeed*1e3;this.moveFlag=!0,CellManager.setCell(this,e,t);var o=egret.Tween.get(this);o.to({x:i,y:a},s,egret.Ease.bounceOut).call(function(){n.moveFlag=!1,n.sendDropOverEvent()},this)},i.getDistance=function(e,t){var n=Math.pow(t.x-e.x,2),i=Math.pow(t.y-e.y,2),a=Math.sqrt(n+i);return a},i.sendDropOverEvent=function(){var e=new GameEvent(GameEvent.DropOver);this.dispatchEvent(e)},t.CellWidth=60,t.CellHeight=60,t}(egret.Sprite);egret.registerClass(Cell,"Cell");var CellManager=function(){function e(){}var t=(__define,e);t.prototype;return e.cleanCellArray=function(){this.cellArray=[];for(var e=0;e<GameConfig.row;e++){this.cellArray.push([]);for(var t=0;t<GameConfig.column;t++)this.cellArray[e].push(null)}},e.genDropCellId=function(){return Math.floor(5*Math.random())+1},e.genInitCellId=function(e,t){if(e>=GameConfig.row)return void console.error("[CellManager] 超过最大行的限制");if(t>=GameConfig.column)return void console.error("[CellManager] 超过最大列的限制");var n=RES.getRes("gameCellCfg_json"),i=n[1];return i[e][t]},e.removeAllCellAction=function(){for(var e in this.cellArray)for(var t in this.cellArray[e]){var n=this.cellArray[e][t];n&&(egret.Tween.removeTweens(n),n.scaleX=n.scaleY=1)}},e.setAllCellCheckFlag=function(e){for(var t in this.cellArray)for(var n in this.cellArray[t]){var i=this.cellArray[t][n];i&&(i.checkFlag=e)}},e.getNowCleanListNum=function(){var e=[];for(var t in this.cellArray)for(var n in this.cellArray[t]){var i=this.cellArray[t][n];if(i&&0==i.checkFlag){var a=[i];this.getSameArrByCell(i,a),a.length>=GameConfig.baseCleanNum&&e.push(a)}}},e.getSameArrByCell=function(e,t){var n=e.row,i=e.column,a=e.id;e.checkFlag=!0;var r=n,s=i-1;if(s>=0){var o=this.cellArray[r][s];o.id==a&&0==o.checkFlag&&(o.checkFlag=!0,this.getSameArrByCell(o,t),t.push(o))}var l=n,h=i+1;if(h<GameConfig.column){var c=this.cellArray[l][h];c.id==a&&0==c.checkFlag&&(c.checkFlag=!0,this.getSameArrByCell(c,t),t.push(c))}var g=n+1,d=i;if(g<GameConfig.row){var u=this.cellArray[g][d];u.id==a&&0==u.checkFlag&&(u.checkFlag=!0,this.getSameArrByCell(u,t),t.push(u))}var v=n-1,f=i;if(v>=0){var E=this.cellArray[v][f];E.id==a&&0==E.checkFlag&&(E.checkFlag=!0,this.getSameArrByCell(E,t),t.push(E))}},e.setCell=function(e,t,n){var i=e.row,a=e.column;this.cellArray[i][a]=null,e.row=t,e.column=n,this.cellArray[t][n]=e},e.cleanCell=function(e){var t=e.row,n=e.column;this.cellArray[t][n]=null},e.getCellPosX=function(e){var t=Cell.CellWidth/2,n=e*(Cell.CellWidth+GameConfig.columnSpace)+t;return n},e.getCellPosY=function(e){var t=Cell.CellHeight/2,n=e*(Cell.CellHeight+GameConfig.rowSpace)+t;return n},e.getTouchCell=function(e,t){for(var n in this.cellArray){var i=this.cellArray[n];for(var a in i){var r=i[a];if(r){var s=r.hitTestPoint(e,t);if(s)return r}}}return null},e.getCleanListID=function(){if(this.cleanList.length>0){var e=this.cleanList[0];return e.id}return 0},e.isInAround=function(e){var t=e.row,n=e.column,i=this.cleanList.length;if(i>0){var a=this.cleanList[i-1],r=a.row,s=a.column;if(!(r!=t+1&&r!=t-1&&r!=t||s!=n+1&&s!=n-1&&s!=n))return!0}return!1},e.getIsLastTwoInCleanList=function(e){var t=this.cleanList.length;if(t>=2){var n=t-2,i=this.cleanList[n];if(i==e)return!0}return!1},e.removeTopItemInCleanList=function(){var e=this.cleanList.length;if(e>0){var t=this.cleanList[e-1];return Util.removeByElements(this.cleanList,t),t}},e.isAllMove=function(){for(var e in this.cellArray){var t=this.cellArray[e];for(var n in t){var i=t[n];if(i&&1==i.moveFlag)return!0}}return!1},e.getEmptyCell=function(){for(var t=[],n=GameConfig.row-1;n>=0;n--)for(var i=0;i<GameConfig.column;i++){var a=e.cellArray[n][i];if(null==a){var r={row:n,column:i};t.push(r)}}return t},e.getDropRowAndColumn=function(e){var t=e.row,n=e.column,i={row:t,column:n};for(t++;t<GameConfig.row;){var a=this.cellArray[t][n];if(null!=a)break;i.row++,t++}return i},e.removeTopLine=function(){var e=this.lineArray.length;if(e>0){var t=this.lineArray[e-1];Util.removeByElements(this.lineArray,t),t.parent&&t.parent.removeChild(t)}},e.cellArray=[],e.cleanList=[],e.lineArray=[],e}();egret.registerClass(CellManager,"CellManager");var DCAgentManager=function(){function e(){}var t=(__define,e);t.prototype;return e.init=function(){},e}();egret.registerClass(DCAgentManager,"DCAgentManager");var GameConfig=function(){function e(){}var t=(__define,e);t.prototype;return e.column=6,e.columnSpace=20,e.row=6,e.rowSpace=20,e.baseCleanNum=3,e}();egret.registerClass(GameConfig,"GameConfig");var GameData=function(){function e(){}var t=(__define,e);t.prototype;return e.reset=function(){this.enterLv=0,this.curStep=0,this.targetStep=0,this.curScore=0,this.targetScore=0,this.isOver=!1,this.isWin=!1},e.initLvData=function(t){this.reset();var n=FileManager.getLvConfigDataById(t);e.targetStep=parseInt(n.step),e.targetScore=parseInt(n.score),e.curStep=e.targetStep,e.enterLv=t},e.enterLv=0,e.curStep=0,e.targetStep=0,e.curScore=0,e.targetScore=0,e.isOver=!1,e.isWin=!1,e}();egret.registerClass(GameData,"GameData");var GameState;!function(e){e[e.DealLogic=0]="DealLogic",e[e.Play=1]="Play"}(GameState||(GameState={}));var GameEnterDlg=function(e){function t(t){e.call(this),this.lv=t,this.skinName="GameEnterDlgSkin",this.initData(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addToStage=function(){this.goImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGo,this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},i.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.init=function(){},i.onClose=function(){SoundsManager.playBtnMusic(),Director.getInstance().popScene()},i.initData=function(){this.lvLabel.text=this.lv.toString();var e=FileManager.getLvConfigDataById(this.lv);if(e){var t="在"+e.step+"步之内达到"+e.score+"分";this.descLabel.text=t}},i.onGo=function(){SoundsManager.playBtnMusic(),GameData.initLvData(this.lv),SceneManager.gotoGame()},t}(eui.Component);egret.registerClass(GameEnterDlg,"GameEnterDlg");var GameEvent=function(e){function t(t,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1),e.call(this,t,n,i)}__extends(t,e);var n=(__define,t);n.prototype;return t.CleanOver="CleanOver",t.DropOver="DropOver",t}(egret.Event);egret.registerClass(GameEvent,"GameEvent");var GameMissionProgress=function(e){function t(){e.call(this),this.skinName="GameMissionProgressSkin",this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addToStage=function(){},i.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.init=function(){},t}(eui.Component);egret.registerClass(GameMissionProgress,"GameMissionProgress");var GameProgress=function(e){function t(){e.call(this),this.skinName="GameProgressSkin",this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addToStage=function(){},i.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.init=function(){},t}(eui.Component);egret.registerClass(GameProgress,"GameProgress");var GameScene=function(e){function t(){e.call(this),this.state=GameState.Play,this.toBottom=250,this.map=null,this.cleanIndex=0,this.UILayer=new GameUI,this.addChild(this.UILayer),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddStage,this),this.onLoadMap()}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onLoadMap=function(){var e=this,t="resource/fruit-juice-world/tmx/map1.tmx",n=new egret.URLLoader;n.dataFormat=egret.URLLoaderDataFormat.TEXT,n.addEventListener(egret.Event.COMPLETE,function(n){var i=egret.XML.parse(n.target.data);e.map=new tiled.TMXTilemap(2e3,2e3,i,t),e.map.render(),e.map.addEventListener(tiled.TMXImageLoadEvent.ALL_IMAGE_COMPLETE,e.onLoaded,e),e.addChildAt(e.map,1)},this),n.load(new egret.URLRequest(t))},i.onLoaded=function(){this.map&&(this.map.visible=!0,this.map.scaleX=this.map.scaleY=8/9)},i.onAddStage=function(){this.initStage(),this.initLinePanel(),this.initCellPanel(),this.initCell(),this.addChildAt(this.UILayer,1e3)},i.initStage=function(){var e=new egret.Sprite;e.name="stageBg",e.graphics.beginFill(10066329,.8),e.graphics.drawRect(0,0,Display.winSize.width,Display.winSize.height),e.graphics.endFill(),e.visible=!1,this.addChild(e)},i.initLinePanel=function(){this.linePanel=new egret.Sprite,this.linePanel.name="linePanel",this.linePanel.width=GameConfig.column*Cell.CellWidth+(GameConfig.column-1)*GameConfig.columnSpace,this.linePanel.height=GameConfig.row*Cell.CellHeight+(GameConfig.row-1)*GameConfig.rowSpace,this.linePanel.anchorOffsetX=this.linePanel.width/2,this.linePanel.anchorOffsetY=this.linePanel.height,this.linePanel.x=Display.winSize.cx,this.linePanel.y=Display.winSize.height-this.toBottom,this.linePanel.graphics.beginFill(65280,0),this.linePanel.graphics.drawRect(0,0,this.linePanel.width,this.linePanel.height),this.linePanel.graphics.endFill(),this.addChild(this.linePanel)},i.initCellPanel=function(){this.cellPanel=new egret.Sprite,this.cellPanel.name="cellPanel",this.cellPanel.width=GameConfig.column*Cell.CellWidth+(GameConfig.column-1)*GameConfig.columnSpace,this.cellPanel.height=GameConfig.row*Cell.CellHeight+(GameConfig.row-1)*GameConfig.rowSpace,this.cellPanel.anchorOffsetX=this.cellPanel.width/2,this.cellPanel.anchorOffsetY=this.cellPanel.height,this.cellPanel.x=Display.winSize.cx,this.cellPanel.y=Display.winSize.height-this.toBottom;var e=new eui.Rect(this.cellPanel.width,this.cellPanel.height,255);e.alpha=0,this.cellPanel.addChild(e),this.cellPanel.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegan,this),this.cellPanel.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),this.cellPanel.addEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),this.cellPanel.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.outSide,this),this.addChild(this.cellPanel)},i.initCell=function(){CellManager.cleanList=[],CellManager.cleanCellArray();for(var e=0;e<GameConfig.row;e++)for(var t=0;t<GameConfig.column;t++){var n=CellManager.genInitCellId(e,t),i=this.createCell(e,t,n);i.x=CellManager.getCellPosX(t),i.y=CellManager.getCellPosY(e)}},i.createCell=function(e,t,n){var i=new Cell(n);return i.row=e,i.column=t,i.addEventListener(GameEvent.CleanOver,this.cleanOneByOne,this),i.addEventListener(GameEvent.DropOver,this.onDropOver,this),CellManager.cellArray[e][t]=i,this.cellPanel.addChild(i),i},i.onBegan=function(e){if(this.state===GameState.Play){this.deleteCleanList();var t=e.stageX,n=e.stageY,i=CellManager.getTouchCell(t,n);if(i){i.setSelect(!0),this.pushCleanCell(i);var a=new egret.Point(i.x,i.y);this.createPointLine(a),this.pointLineBeganCell=i}}},i.deleteCleanList=function(){CellManager.cleanList=[],CellManager.lineArray=[],this.cleanIndex=0},i.pushCleanCell=function(e){CellManager.cleanList.push(e);var t=CellManager.cleanList.length;if(t>1){var n=CellManager.cleanList[t-2];this.drawLine(n,e)}},i.drawLine=function(e,t){var n=RES.getRes("line_png"),i=new eui.Image;i.texture=n,i.anchorOffsetX=0,i.anchorOffsetY=n.textureHeight/2,this.linePanel.addChild(i),CellManager.lineArray.push(i),i.x=e.x,i.y=e.y;var a=new egret.Point(e.x,e.y),r=new egret.Point(t.x,t.y),s=egret.Point.distance(a,r);i.width=s;var o=this.getAngle(a,r);i.rotation=o},i.getAngle=function(e,t){var n=(t.x-e.x,Math.abs(t.y-e.y)),i=egret.Point.distance(e,t),a=Math.round(Math.asin(n/i)/Math.PI*180);return e.x>t.x?e.y>t.y?a+=180:e.y<t.y?a=180-a:e.y==t.y&&(a=180):e.x<t.x?e.y>t.y?a=360-a:e.y<t.y?a=a:e.y==t.y&&(a=0):e.x==t.x&&(e.y>t.y?a=270:e.y<t.y&&(a=90)),a},i.createPointLine=function(e){this.pointLine&&this.pointLine.parent&&this.pointLine.parent.removeChild(this.pointLine),this.pointLine=new eui.Image,this.pointLine.texture=RES.getRes("line_png"),this.pointLine.width=0,this.pointLine.anchorOffsetX=0,this.pointLine.anchorOffsetY=this.pointLine.height/2,this.pointLine.x=e.x,this.pointLine.y=e.y,this.linePanel.addChild(this.pointLine)},i.onMove=function(e){if(this.state==GameState.Play){var t=e.stageX,n=e.stageY;this.updatePointLineEnd(t,n);var i=CellManager.getTouchCell(t,n);if(i)if(i.isSelected){var a=CellManager.getIsLastTwoInCleanList(i);if(a){CellManager.removeTopLine();var r=CellManager.removeTopItemInCleanList();r.setSelect(!1),this.updatePointLineBegan(t,n)}}else{var s=CellManager.getCleanListID(),o=CellManager.isInAround(i);i.id===s&&o&&(i.setSelect(!0),this.pushCleanCell(i),this.updatePointLineBegan(t,n))}}},i.onEnd=function(){var e=CellManager.cleanList.length;e>=GameConfig.baseCleanNum&&this.state==GameState.Play&&(this.state=GameState.DealLogic,this.cleanOneByOne());for(var t in CellManager.cleanList){var n=CellManager.cleanList[t];n.setSelect(!1)}this.cleanAllLine()},i.cleanAllLine=function(){this.linePanel.removeChildren()},i.cleanOneByOne=function(){var e=CellManager.cleanList.length;if(0==e)this.deleteCleanList(),this.dropAndFillCell();else{var t=CellManager.cleanList[0];this.createDirtyAndScore(t),t.clean(),SoundsManager.playRemoveCellMusic(this.cleanIndex),this.cleanIndex++}},i.createDirtyAndScore=function(e){var t=["apple_png","blueberry_png","mangosteen_png","lemon_png","watermelon_png"],n=e.id,i=new eui.Image(t[n-1]),a=RES.getRes(t[n-1]);i.anchorOffsetX=a.textureWidth/2,i.anchorOffsetY=a.textureHeight/2,i.x=e.x,i.y=e.y,i.scaleX=i.scaleY=0,i.rotation=360*Math.random(),this.cellPanel.addChild(i),egret.Tween.get(i).to({scaleX:1.2,scaleY:1.2},400,egret.Ease.bounceOut).wait(200).to({alpha:0},100).call(function(){i.parent&&i.parent.removeChild(i)});var r=10;this.UILayer.addScore(r);var s=new eui.Label;s.text="10",s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s.x=e.x,s.y=e.y,this.cellPanel.addChild(s),egret.Tween.get(s).to({y:e.y-40},400).call(function(){s.parent&&s.parent.removeChild(s)},this)},i.dropAndFillCell=function(){for(var e=GameConfig.row-1;e>=0;e--)for(var t=0;t<GameConfig.column;t++){var n=CellManager.cellArray[e][t];if(null!=n){var i=CellManager.getDropRowAndColumn(n),a=i.row,r=i.column;(n.row!=a||n.column!=r)&&n.drop(i.row,i.column)}}var s=CellManager.getEmptyCell();for(var o in s){var l=s[o].row,h=s[o].column,c=CellManager.genDropCellId(),g=this.createCell(l,h,c);g.x=CellManager.getCellPosX(h),g.y=-Cell.CellHeight/2,g.drop(l,h)}},i.updatePointLineBegan=function(e,t){var n=CellManager.cleanList.length;if(n>0){var i=CellManager.cleanList[n-1];this.pointLineBeganCell=i,this.updatePointLineEnd(e,t)}},i.updatePointLineEnd=function(e,t){if(this.pointLine&&this.pointLineBeganCell){var n=new egret.Point(this.pointLineBeganCell.x,this.pointLineBeganCell.y),i=this.linePanel.globalToLocal(e,t),a=egret.Point.distance(n,i);this.pointLine.width=a,this.pointLine.x=n.x,this.pointLine.y=n.y,this.pointLine.anchorOffsetX=0,this.pointLine.anchorOffsetY=this.pointLine.height/2;var r=this.getAngle(n,i);this.pointLine.rotation=r}},i.onDropOver=function(){var e=CellManager.isAllMove();0==e&&this.onStepOver()},i.onStepOver=function(){this.state=GameState.Play,this.UILayer.reduceStep()},i.outSide=function(){this.onEnd()},t}(egret.DisplayObjectContainer);egret.registerClass(GameScene,"GameScene");var GameUI=function(e){function t(){e.call(this),this.star=0,this.skinName="GameUISkin",this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addToStage=function(){this.progress.value=0,this.gold.text="0",this.score.text="0",this.targetScore.text=GameData.targetScore.toString(),this.lv.text=GameData.enterLv.toString(),this.stepScore.text=GameData.targetStep.toString(),this.pauseBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPause,this)},i.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.addScore=function(e){GameData.curScore+=e,this.score.text=GameData.curScore.toString();var t=GameData.targetScore,n=1.5*GameData.targetScore,i=2*GameData.targetScore;GameData.curScore<t?this.showStar(0):GameData.curScore>=t&&GameData.curScore<n?this.showStar(1):GameData.curScore>=n&&GameData.curScore<i?this.showStar(2):this.showStar(3);var a=GameData.curScore/i*100;this.progress.value=a},i.showStar=function(e){this.star=e,this.star1.source="game_rate1_off_png",this.star2.source="game_rate2_off_png",this.star3.source="game_rate3_off_png",1==e?this.star1.source="game_rate1_png":2==e?this.star2.source="game_rate2_png":3==e&&(this.star3.source="game_rate3_png")},i.reduceStep=function(){GameData.curStep--,this.stepScore.text=GameData.curStep.toString(),GameData.curStep<=0?(GameData.curStep=0,0==GameData.isOver&&(GameData.isOver=!0,GameData.isWin=!1,this.addDefeatLayer())):GameData.curScore>=GameData.targetScore&&0==GameData.isOver&&(GameData.isOver=!0,GameData.isWin=!0,this.addWinLayer())},i.addWinLayer=function(){Director.getInstance().pushScene(new WinUI(this.star))},i.addDefeatLayer=function(){Director.getInstance().pushScene(new LoseLayer)},i.onPause=function(){SoundsManager.playBtnMusic(),this.addChild(new PauseLayer)},i.onBtn=function(){},t}(eui.Component);egret.registerClass(GameUI,"GameUI");var LevelState;!function(e){e[e.NONE=0]="NONE",e[e.OPEN=1]="OPEN",e[e.CLOSE=2]="CLOSE"}(LevelState||(LevelState={}));var IndexButton=function(e){function t(){e.call(this),this.state=LevelState.NONE,this.lvNumber=0,this.skinName="IndexButtonSkin",this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)}__extends(t,e);var n=__define,i=t,a=i.prototype;return a.addToStage=function(){},a.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},a.init=function(){},n(a,"lv",function(){return this.lvNumber},function(e){this.lvNumber=e,this.lvLabel.text=this.lvNumber+"",this.lvNumber<PlayerData.data.fightLv?this.setData(LevelState.OPEN):this.lvNumber==PlayerData.data.fightLv?(this.setData(LevelState.OPEN),this.showIcon()):this.setData(LevelState.CLOSE)}),a.setData=function(e){this.state=e,this.bg.source=this.getStateImage()},a.showIcon=function(){this.icon.visible=!0;var e=egret.Tween.get(this.icon,{loop:!0}),t=this.icon.y;e.to({y:t+20},1200,egret.Ease.backIn).to({y:t},500,egret.Ease.backOut)},a.getStateImage=function(){return this.state==LevelState.OPEN?"selet_g_green_png":this.state==LevelState.CLOSE?"selet_g_lock_png":""},t}(eui.Component);egret.registerClass(IndexButton,"IndexButton");var IndexGroup=function(e){function t(){e.call(this),this.skinName="IndexGroupSkin",this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addToStage=function(){var e=[this.btn1,this.btn2,this.btn3,this.btn4,this.btn5,this.btn6,this.btn7,this.btn8,this.btn9,this.btn10,this.btn11,this.btn12,this.btn13];for(var t in e){var n=e[t];n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this)}},i.clickBtn=function(e){SoundsManager.playBtnMusic();var t=e.currentTarget,n=t.lv;n<=PlayerData.data.fightLv?Director.getInstance().pushScene(new GameEnterDlg(n)):(new Tips).show("不能进入")},i.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.init=function(){},t}(eui.Component);egret.registerClass(IndexGroup,"IndexGroup");var IndexScene=function(e){function t(){e.call(this),this.prePoint=new egret.Point,this.skinName="IndexSceneSkin",this.indexUI=new IndexUI,this.addChild(this.indexUI),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addToStage=function(){this.initData(),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegan,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this)},i.initData=function(){this.list.addChild(new IndexGroup);var e={1:0,2:0,3:0,4:256,5:559,6:778,7:1e3,8:1284,9:1461,10:1617,11:1640,12:1640,13:1640};this.list.scrollV=e[PlayerData.data.fightLv.toString()]},i.onBegan=function(e){this.prePoint.x=e.stageX,this.prePoint.y=e.stageY},i.onMove=function(e){this.prePoint.x=e.stageX,this.prePoint.y=e.stageY},i.onEnd=function(e){this.prePoint.x=e.stageX,this.prePoint.y=e.stageY},i.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.init=function(){},t}(eui.Component);egret.registerClass(IndexScene,"IndexScene");var IndexUI=function(e){function t(){e.call(this),this.skinName="IndexUISkin",this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addStage,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addStage=function(){this.addGoldBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){(new Tips).show("功能暂未开放")},this),this.addHeartBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){(new Tips).show("功能暂未开放")},this)},t}(eui.Component);egret.registerClass(IndexUI,"IndexUI");var ResLoading=function(e){function t(){e.call(this),this.loadGroups=[],this.skinName="ResLoadingSkin",this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addToStage=function(){this.addEventListener(egret.Event.ENTER_FRAME,this.update,this)},i.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.update=function(){this.circle.rotation+=3},i.init=function(){},i.load=function(e,t){egret.log("[ResLoading] 加载组:"+e),this.index=0,this.loadGroups=e,this.callback=t,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(this.loadGroups[this.index])},i.onResourceLoadComplete=function(e){var t=this.isAllLoaded();egret.log("[LoadingCircle] group "+e.groupName+" loaded"),t?this.loadFinish():(this.index++,RES.loadGroup(this.loadGroups[this.index]))},i.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},i.onResourceProgress=function(e){this.setProgress(e.itemsLoaded,e.itemsTotal)},i.setProgress=function(e,t){this.textLabel.text=e+"/"+t},i.loadFinish=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.parent&&this.parent.removeChild(this),this.callback&&this.callback.exec()},i.isAllLoaded=function(){for(var e=!0,t=0;t<this.loadGroups.length;t++)e=e&&RES.isGroupLoaded(this.loadGroups[t]);return e},t}(eui.Component);egret.registerClass(ResLoading,"ResLoading");var Login=function(e){function t(){e.call(this),this.skinName="LoginSkin",this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)
}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addToStage=function(){this.initDB(),this.beganBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBegan,this),egret.Tween.get(this.beganBtn,{loop:!0}).to({scaleX:.8,scaleY:.8},1e3).to({scaleX:1,scaleY:1},1e3)},i.initDB=function(){var e=RES.getRes("tree_json"),t=RES.getRes("textureTree_json"),n=RES.getRes("textureTree_png"),i=new dragonBones.EgretFactory;i.addDragonBonesData(dragonBones.DataParser.parseDragonBonesData(e)),i.addTextureAtlas(new dragonBones.EgretTextureAtlas(n,t));var a=i.buildArmature("Armature");this.treeGroup.addChild(a.display),a.display.x=150,a.display.y=200,dragonBones.WorldClock.clock.add(a),a.animation.gotoAndPlay("run",-1,-1,0),egret.Ticker.getInstance().register(function(){dragonBones.WorldClock.clock.advanceTime(.01)},this)},i.onBegan=function(){SoundsManager.playBtnMusic(),SceneManager.gotoIndex()},i.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.init=function(){},t}(eui.Component);egret.registerClass(Login,"Login");var LoseLayer=function(e){function t(){e.call(this),this.skinName="LoseLayerSkin",this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addToStage=function(){this.btnAgain.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){SceneManager.replayLv()},this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Director.getInstance().replaceScene(new IndexScene)},this)},i.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.init=function(){},t}(eui.Component);egret.registerClass(LoseLayer,"LoseLayer");var PauseLayer=function(e){function t(){e.call(this),this.skinName="PauseLayerSkin",this.init(),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addToStage=function(){var e=this;this.btn1.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){SoundsManager.playBtnMusic(),e.parent&&e.parent.removeChild(e)},this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){SoundsManager.playBtnMusic(),SceneManager.replayLv()},this),this.btn3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){SoundsManager.playBtnMusic(),Director.getInstance().replaceScene(new IndexScene)},this)},i.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.init=function(){},t}(eui.Component);egret.registerClass(PauseLayer,"PauseLayer");var WinUI=function(e){function t(t){e.call(this),this.star=0,this.skinName="WinUISkin",this.star=t,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this),SoundsManager.playWinMusic()}__extends(t,e);var n=(__define,t),i=n.prototype;return i.initStar=function(){var e=[this.star1,this.star2,this.star3];for(var t in e)e[t].visible=!1;for(var t=0;t<this.star;t++)e[t].visible=!0},i.addToStage=function(){this.btn1Bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn1,this),this.btn2Bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn2,this),this.btn3Bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn3,this),this.init(),this.saveData(),this.initStar()},i.saveData=function(){PlayerData.saveLv(GameData.enterLv+1)},i.removeFromStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeFromStage,this)},i.init=function(){this.numLabel.text=GameData.curScore+""},i.clickBtn1=function(){SceneManager.gotoIndex()},i.clickBtn2=function(){SceneManager.replayLv()},i.clickBtn3=function(){GameData.initLvData(GameData.enterLv+1),SceneManager.gotoGame()},t}(eui.Component);egret.registerClass(WinUI,"WinUI");var Net=function(){function e(){this._url="http://localhost:63342/workerMan/Game/Test.php"}var t=(__define,e),n=t.prototype;return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},n.sendHttpRequest=function(e,t){void 0===t&&(t=null);var n=new egret.URLLoader;n.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this),n.dataFormat=egret.URLLoaderDataFormat.TEXT;var i=JSON.stringify(t),a=new egret.URLVariables;a.variables={msg:e,data:i};var r=new egret.URLRequest;r.method=egret.URLRequestMethod.POST,r.url=this._url,r.data=a,n.load(r)},n.onLoadError=function(){console.log("服务器连接失败")},n.onLoadComplete=function(e){var t=e.target,n=t.data;egret.log("返回数据："+n)},e.instance=null,e}();egret.registerClass(Net,"Net");var NetError=function(e){function t(t){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(eui.Component);egret.registerClass(NetError,"NetError");var NetMsg=function(){function e(){}var t=(__define,e);t.prototype;return e.arr={chat:{send:"chat.sendMsg"}},e}();egret.registerClass(NetMsg,"NetMsg");var NetWait=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(eui.Component);egret.registerClass(NetWait,"NetWait");var ThemeAdapter=function(){function e(){}var t=(__define,e),n=t.prototype;return n.getTheme=function(e,t,n,i){function a(e){t.call(i,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);var CallBackFunc=function(){function e(){this.callBack=null,this.thisObj=null,this.args=[]}var t=(__define,e),n=t.prototype;return n.handler=function(e,t,n){return this.callBack=e,this.thisObj=t,this.args=n,this},n.exec=function(e){return void 0===e&&(e=null),e&&(this.args=e),null!=this.callBack&&null!=this.thisObj?this.callBack.apply(this.thisObj,this.args):void 0},e}();egret.registerClass(CallBackFunc,"CallBackFunc");var Director=function(){function e(){this.gameLayer=null,this.netLayer=null,this.guidLayer=null,this.stackLayer=[]}var t=(__define,e),n=t.prototype;return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},n.initWithMain=function(e){null==this.gameLayer&&(this.gameLayer=e),null==this.netLayer&&(this.netLayer=new NetLayerUtil,Display.stage.addChildAt(this.netLayer,9)),null==this.guidLayer&&(this.guidLayer=new GuidLayerUtil,Display.stage.addChildAt(this.guidLayer,10))},n.replaceScene=function(e){null!=this.gameLayer&&null!=e&&(this.gameLayer.removeChildren(),this.gameLayer.addChild(e))},n.pushScene=function(e){null!=this.gameLayer&&null!=e&&(this.gameLayer.addChild(e),this.stackLayer.push(e))},n.popScene=function(){if(null!=this.gameLayer){var e=this.stackLayer.length;if(e>0){var t=this.stackLayer[e-1];t.parent==this.gameLayer&&(this.gameLayer.removeChild(t),Util.removeByElements(this.stackLayer,t))}}},n.addGuidLayer=function(){this.guidLayer.addGuidLayer()},n.getCurGuidLayer=function(){return this.guidLayer.curLayer},n.cleanGuidLayer=function(){this.guidLayer.cleanGuidLayer()},n.addNetWaitLayer=function(){this.netLayer.addWaitLayer()},n.addNetOutLineLayer=function(){this.netLayer.addOutLineLayer()},n.addNetErrorLayer=function(){this.netLayer.addErrorLayer()},n.cleanNetLayer=function(){this.netLayer.cleanLayer()},e.instance=null,e}();egret.registerClass(Director,"Director");var Display=function(){function e(){}var t=__define,n=e;n.prototype;return t(e,"winSize",function(){return this._winSize.width=egret.MainContext.instance.stage.stageWidth,this._winSize.height=egret.MainContext.instance.stage.stageHeight,this._winSize.cx=this._winSize.width/2,this._winSize.cy=this._winSize.height/2,this._winSize}),t(e,"stage",function(){return egret.MainContext.instance.stage}),e._winSize={width:0,height:0,cx:0,cy:0},e}();egret.registerClass(Display,"Display");var GuidLayerUtil=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addGuidLayer=function(){},i.cleanGuidLayer=function(){this.removeChildren()},t}(egret.DisplayObjectContainer);egret.registerClass(GuidLayerUtil,"GuidLayerUtil");var NetLayerUtil=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.addWaitLayer=function(){this.removeChildren();var e=new NetWait;this.curLayer=e,this.addChild(e)},i.addOutLineLayer=function(){this.removeChildren();var e=new NetError("该账号已在其他地方登录,是否重新登录?");this.curLayer=e,this.addChild(e)},i.addErrorLayer=function(){this.removeChildren();var e=new NetError;this.curLayer=e,this.addChild(e)},i.cleanLayer=function(){this.removeChildren()},t}(egret.DisplayObjectContainer);egret.registerClass(NetLayerUtil,"NetLayerUtil");var Tips=function(e){function t(){e.call(this),this.bg=new eui.Image,this.bg.source=RES.getRes("tips_png"),this.bg.scale9Grid=new egret.Rectangle(55,12,9,4),this.addChild(this.bg),this.width=121,this.height=30,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.label=new eui.Label,this.addChild(this.label),this.x=Display.winSize.width/2,this.y=Display.winSize.height-100,egret.MainContext.instance.stage.addChildAt(this,1e5)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.show=function(e){this.label.text=e,this.label.anchorOffsetX=this.label.width/2,this.label.anchorOffsetY=this.label.height/2,this.label.x=this.width/2,this.label.y=this.height/2,this.bg.width=this.label.width+50,this.bg.height=this.label.height+20,this.bg.anchorOffsetX=this.bg.width/2,this.bg.anchorOffsetY=this.bg.height/2,this.bg.x=this.width/2,this.bg.y=this.height/2;var t=egret.Tween.get(this);t.to({x:Display.winSize.width/2,y:Display.winSize.height-200},1500,egret.Ease.backOut).call(this.callback,this)},i.callback=function(){this.parent.removeChild(this)},t}(egret.DisplayObjectContainer);egret.registerClass(Tips,"Tips");var Util=function(){function e(){}var t=(__define,e);t.prototype;return e.removeByElements=function(e,t){for(var n=-1,i=e.length,a=0;i>a;a++)if(e[a]==t){n=a;break}n>=0&&e.splice(n,1)},e.formatString=function(e){for(var t,n,i,a,r,s=0,o=e[s++],l=[],h="";o;){if(n=/^[^\x25]+/.exec(o))l.push(n[0]);else if(n=/^\x25{2}/.exec(o))l.push("%");else{if(!(n=/^\x25(?:(\d+)\$)?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(o)))throw"Huh ?!";if(null==(t=e[n[1]||s++])||void 0==t)throw"Too few arguments.";if(/[^s]/.test(n[7])&&"number"!=typeof t)throw"Expecting number but found "+typeof t;switch(n[7]){case"b":t=t.toString(2);break;case"c":t=String.fromCharCode(t);break;case"d":t=parseInt(t);break;case"e":t=n[6]?t.toExponential(n[6]):t.toExponential();break;case"f":t=n[6]?parseFloat(t).toFixed(n[6]):parseFloat(t);break;case"o":t=t.toString(8);break;case"s":t=(t=String(t))&&n[6]?t.substring(0,n[6]):t;break;case"u":t=Math.abs(t);break;case"x":t=t.toString(16);break;case"X":t=t.toString(16).toUpperCase()}t=/[def]/.test(n[7])&&n[2]&&t>=0?"+"+t:t,a=n[3]?"0"==n[3]?"0":n[3].charAt(1):" ",r=n[5]-String(t).length-h.length,i=n[5]?this.str_repeat(a,r):"",l.push(h+(n[4]?t+i:i+t))}o=o.substring(n[0].length)}return l.join("")},e.str_repeat=function(e,t){return new Array(t+1).join(e)},e}();egret.registerClass(Util,"Util");var _Animation=function(){function e(){}var t=(__define,e);t.prototype;return e.makeAni=function(e){var t=RES.getRes(e+"_json"),n=RES.getRes(e+"_png");if(t&&n){var i=new egret.MovieClipDataFactory(t,n),a=new egret.MovieClip(i.generateMovieClipData("ani"));return a.frameRate=10,a}return egret.log("[_Animation] 动画文件有问题 "+e),null},e.makeParticle=function(e){},e}();egret.registerClass(_Animation,"_Animation");